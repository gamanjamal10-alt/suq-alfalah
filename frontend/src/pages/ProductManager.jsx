import React,{useEffect,useState} from 'react';export default function ProductManager(){const [products,setProducts]=useState([]);const [name,setName]=useState('');const [price,setPrice]=useState('');const [quantity,setQuantity]=useState('');const [description,setDescription]=useState('');const token=localStorage.getItem('token');const API_URL=import.meta.env.VITE_API_URL||'http://localhost:5000/api';useEffect(()=>{fetch(`${API_URL}/products/my`,{headers:{Authorization:`Bearer ${token}`}}).then(r=>r.json()).then(d=>setProducts(d))},[token]);const add=async(e)=>{e.preventDefault();const res=await fetch(`${API_URL}/products`,{method:'POST',headers:{'Content-Type':'application/json',Authorization:`Bearer ${token}`},body:JSON.stringify({name,price:Number(price),quantity:Number(quantity),description})});const data=await res.json();if(res.ok){setProducts([...products,data]);setName('');setPrice('');setQuantity('');setDescription('');}};const del=async(id)=>{if(!confirm('هل أنت متأكد؟'))return;await fetch(`${API_URL}/products/${id}`,{method:'DELETE',headers:{Authorization:`Bearer ${token}`}});setProducts(products.filter(p=>p._id!==id));};return(<div className='p-8'><h1 className='text-2xl mb-6'>إدارة المنتجات</h1><form onSubmit={add} className='bg-white p-4 rounded shadow mb-8'><h2 className='text-xl mb-4'>إضافة منتج جديد</h2><input type='text' placeholder='اسم المنتج' value={name} onChange={e=>setName(e.target.value)} className='w-full mb-2 p-2 border rounded' required/><input type='number' placeholder='السعر' value={price} onChange={e=>setPrice(e.target.value)} className='w-full mb-2 p-2 border rounded' required/><input type='number' placeholder='الكمية' value={quantity} onChange={e=>setQuantity(e.target.value)} className='w-full mb-2 p-2 border rounded' required/><textarea placeholder='الوصف' value={description} onChange={e=>setDescription(e.target.value)} className='w-full mb-2 p-2 border rounded'/><button className='bg-green-600 text-white w-full py-2 rounded'>إضافة</button></form><table className='w-full bg-white rounded shadow'><thead><tr className='bg-gray-200 text-left'><th className='p-2'>المنتج</th><th className='p-2'>السعر</th><th className='p-2'>الكمية</th><th className='p-2'>الوصف</th><th className='p-2'>إجراءات</th></tr></thead><tbody>{products.map(product=>(<tr key={product._id} className='border-b'><td className='p-2'>{product.name}</td><td className='p-2'>{product.price} دج</td><td className='p-2'>{product.quantity}</td><td className='p-2'>{product.description}</td><td className='p-2'><button onClick={()=>del(product._id)} className='bg-red-600 text-white px-3 py-1 rounded'>حذف</button></td></tr>))}{products.length===0&&(<tr><td colSpan='5' className='p-4 text-center text-gray-500'>لا توجد منتجات بعد</td></tr>)}</tbody></table></div>)};
